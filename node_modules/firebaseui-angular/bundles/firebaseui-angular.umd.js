(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('angularfire2/auth'), require('firebaseui'), require('tslib'), require('firebase'), require('@angular/common')) :
    typeof define === 'function' && define.amd ? define('firebaseui-angular', ['exports', '@angular/core', 'angularfire2/auth', 'firebaseui', 'tslib', 'firebase', '@angular/common'], factory) :
    (factory((global['firebaseui-angular'] = {}),global.ng.core,null,null,global.tslib,null,global.ng.common));
}(this, (function (exports,i0,i1,firebaseui,tslib_1,firebase,common) { 'use strict';

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var FirebaseuiAngularLibraryService = (function () {
        function FirebaseuiAngularLibraryService(angularFireAuth) {
            // store the firebaseui instance on the window object to prevent double initialization
            if (!((window)).firebaseUiInstance) {
                ((window)).firebaseUiInstance = new firebaseui.auth.AuthUI(angularFireAuth.auth);
            }
            this.firebaseUiInstance = /** @type {?} */ (((window)).firebaseUiInstance);
        }
        FirebaseuiAngularLibraryService.decorators = [
            { type: i0.Injectable, args: [{
                        providedIn: 'root'
                    },] },
        ];
        /** @nocollapse */
        FirebaseuiAngularLibraryService.ctorParameters = function () {
            return [
                { type: i1.AngularFireAuth, },
            ];
        };
        /** @nocollapse */ FirebaseuiAngularLibraryService.ngInjectableDef = i0.defineInjectable({ factory: function FirebaseuiAngularLibraryService_Factory() { return new FirebaseuiAngularLibraryService(i0.inject(i1.AngularFireAuth)); }, token: FirebaseuiAngularLibraryService, providedIn: "root" });
        return FirebaseuiAngularLibraryService;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /*
     * Created by Raphael Jenni
     * Copyright (c) 2017 Raphael Jenni
     */
    var FirebaseUIAuthConfig = (function () {
        function FirebaseUIAuthConfig() {
        }
        return FirebaseUIAuthConfig;
    }());
    var FirebaseUISignInSuccess = (function () {
        function FirebaseUISignInSuccess() {
        }
        return FirebaseUISignInSuccess;
    }());
    /** @enum {number} */
    var CredentialHelper = {
        AccountChooser: 0,
        OneTap: 1,
        None: 2,
    };
    CredentialHelper[CredentialHelper.AccountChooser] = "AccountChooser";
    CredentialHelper[CredentialHelper.OneTap] = "OneTap";
    CredentialHelper[CredentialHelper.None] = "None";
    /** @enum {number} */
    var AuthProvider = {
        Google: 0,
        Facebook: 1,
        Twitter: 2,
        Github: 3,
        Password: 4,
        Phone: 5,
    };
    AuthProvider[AuthProvider.Google] = "Google";
    AuthProvider[AuthProvider.Facebook] = "Facebook";
    AuthProvider[AuthProvider.Twitter] = "Twitter";
    AuthProvider[AuthProvider.Github] = "Github";
    AuthProvider[AuthProvider.Password] = "Password";
    AuthProvider[AuthProvider.Phone] = "Phone";
    /** @enum {number} */
    var AuthMethods = {
        Popup: 0,
        Redirect: 1,
    };
    AuthMethods[AuthMethods.Popup] = "Popup";
    AuthMethods[AuthMethods.Redirect] = "Redirect";

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var GoogleAuthProvider = firebase.auth.GoogleAuthProvider;
    var FacebookAuthProvider = firebase.auth.FacebookAuthProvider;
    var TwitterAuthProvider = firebase.auth.TwitterAuthProvider;
    var GithubAuthProvider = firebase.auth.GithubAuthProvider;
    var EmailAuthProvider = firebase.auth.EmailAuthProvider;
    var PhoneAuthProvider = firebase.auth.PhoneAuthProvider;
    var FirebaseuiAngularLibraryComponent = (function () {
        function FirebaseuiAngularLibraryComponent(angularFireAuth, firebaseUiConfig, firebaseUIService) {
            this.angularFireAuth = angularFireAuth;
            this.firebaseUiConfig = firebaseUiConfig;
            this.firebaseUIService = firebaseUIService;
            this.signInSuccessCallback = new i0.EventEmitter();
        }
        /**
         * @param {?} provider
         * @return {?}
         */
        FirebaseuiAngularLibraryComponent.getAuthProvider = /**
         * @param {?} provider
         * @return {?}
         */
            function (provider) {
                switch (provider) {
                    case AuthProvider.Google:
                        return GoogleAuthProvider.PROVIDER_ID;
                    case AuthProvider.Facebook:
                        return FacebookAuthProvider.PROVIDER_ID;
                    case AuthProvider.Twitter:
                        return TwitterAuthProvider.PROVIDER_ID;
                    case AuthProvider.Github:
                        return GithubAuthProvider.PROVIDER_ID;
                    case AuthProvider.Password:
                        return EmailAuthProvider.PROVIDER_ID;
                    case AuthProvider.Phone:
                        return PhoneAuthProvider.PROVIDER_ID;
                }
            };
        /**
         * @return {?}
         */
        FirebaseuiAngularLibraryComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                var _this = this;
                this.subscription = this.angularFireAuth.authState.subscribe(function (value) {
                    if (!value) {
                        if (_this.firebaseUiConfig.providers.length !== 0) {
                            _this.firebaseUIPopup();
                        }
                        else {
                            throw new Error('There must be at least one AuthProvider.');
                        }
                    }
                });
            };
        /**
         * @return {?}
         */
        FirebaseuiAngularLibraryComponent.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                if (!!this.subscription) {
                    this.subscription.unsubscribe();
                }
            };
        /**
         * @param {?} authConfig
         * @return {?}
         */
        FirebaseuiAngularLibraryComponent.prototype.getUIAuthConfig = /**
         * @param {?} authConfig
         * @return {?}
         */
            function (authConfig) {
                var _this = this;
                var /** @type {?} */ authProviders = [];
                try {
                    for (var _a = tslib_1.__values(authConfig.providers), _b = _a.next(); !_b.done; _b = _a.next()) {
                        var provider = _b.value;
                        if (!!((provider)).customConfig) {
                            provider = ((provider));
                            var /** @type {?} */ providerWithConfig = provider.customConfig;
                            providerWithConfig['provider'] = FirebaseuiAngularLibraryComponent.getAuthProvider(provider.provider);
                            authProviders.push(providerWithConfig);
                        }
                        else {
                            authProviders.push(FirebaseuiAngularLibraryComponent.getAuthProvider(/** @type {?} */ (provider)));
                        }
                    }
                }
                catch (e_1_1) {
                    e_1 = { error: e_1_1 };
                }
                finally {
                    try {
                        if (_b && !_b.done && (_c = _a.return))
                            _c.call(_a);
                    }
                    finally {
                        if (e_1)
                            throw e_1.error;
                    }
                }
                var /** @type {?} */ tosURL = authConfig.tos ? authConfig.tos : '';
                var /** @type {?} */ authMethod = 'popup';
                switch (authConfig.method) {
                    case AuthMethods.Redirect:
                        authMethod = 'redirect';
                        break;
                    case null:
                    case AuthMethods.Popup:
                    default:
                        break;
                }
                var /** @type {?} */ credentialHelper;
                switch (authConfig.credentialHelper) {
                    case CredentialHelper.None:
                        credentialHelper = firebaseui.auth.CredentialHelper.NONE;
                        break;
                    case CredentialHelper.OneTap:
                        credentialHelper = firebaseui.auth.CredentialHelper.GOOGLE_YOLO;
                        break;
                    case CredentialHelper.AccountChooser:
                    default:
                        credentialHelper = firebaseui.auth.CredentialHelper.ACCOUNT_CHOOSER_COM;
                        break;
                }
                var /** @type {?} */ nativeConfiguration = {
                    callbacks: {
                        signInSuccess: function (currentUser, credential, redirectUrl) {
                            _this.signInSuccessCallback.emit({
                                currentUser: currentUser,
                                credential: credential,
                                redirectUrl: redirectUrl
                            });
                            return !!authConfig.signInSuccessUrl;
                        }
                    },
                    signInFlow: authMethod,
                    signInOptions: authProviders,
                    tosUrl: tosURL,
                    credentialHelper: credentialHelper
                };
                if (!!authConfig.signInSuccessUrl) {
                    nativeConfiguration.signInSuccessUrl = authConfig.signInSuccessUrl;
                }
                return nativeConfiguration;
                var e_1, _c;
            };
        /**
         * @return {?}
         */
        FirebaseuiAngularLibraryComponent.prototype.firebaseUIPopup = /**
         * @return {?}
         */
            function () {
                var /** @type {?} */ firebaseUiInstance = this.firebaseUIService.firebaseUiInstance;
                firebaseUiInstance.start('#firebaseui-auth-container', this.getUIAuthConfig(this.firebaseUiConfig));
            };
        FirebaseuiAngularLibraryComponent.decorators = [
            { type: i0.Component, args: [{
                        selector: 'firebase-ui',
                        template: "\n    <div id=\"firebaseui-auth-container\"></div>"
                    },] },
        ];
        /** @nocollapse */
        FirebaseuiAngularLibraryComponent.ctorParameters = function () {
            return [
                { type: i1.AngularFireAuth, },
                { type: FirebaseUIAuthConfig, },
                { type: FirebaseuiAngularLibraryService, },
            ];
        };
        FirebaseuiAngularLibraryComponent.propDecorators = {
            "signInSuccessCallback": [{ type: i0.Output, args: ['signInSuccess',] },],
        };
        return FirebaseuiAngularLibraryComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var FirebaseUIModule = (function () {
        function FirebaseUIModule() {
        }
        /**
         * @param {?} firebaseUiAuthConfig
         * @return {?}
         */
        FirebaseUIModule.forRoot = /**
         * @param {?} firebaseUiAuthConfig
         * @return {?}
         */
            function (firebaseUiAuthConfig) {
                return {
                    ngModule: FirebaseUIModule,
                    providers: [
                        { provide: FirebaseUIAuthConfig, useValue: firebaseUiAuthConfig }
                    ]
                };
            };
        FirebaseUIModule.decorators = [
            { type: i0.NgModule, args: [{
                        imports: [
                            common.CommonModule
                        ],
                        declarations: [FirebaseuiAngularLibraryComponent],
                        exports: [FirebaseuiAngularLibraryComponent]
                    },] },
        ];
        return FirebaseUIModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    exports.FirebaseuiAngularLibraryService = FirebaseuiAngularLibraryService;
    exports.FirebaseuiAngularLibraryComponent = FirebaseuiAngularLibraryComponent;
    exports.FirebaseUIAuthConfig = FirebaseUIAuthConfig;
    exports.FirebaseUISignInSuccess = FirebaseUISignInSuccess;
    exports.CredentialHelper = CredentialHelper;
    exports.AuthProvider = AuthProvider;
    exports.AuthMethods = AuthMethods;
    exports.FirebaseUIModule = FirebaseUIModule;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlyZWJhc2V1aS1hbmd1bGFyLnVtZC5qcy5tYXAiLCJzb3VyY2VzIjpbIm5nOi8vZmlyZWJhc2V1aS1hbmd1bGFyL2xpYi9maXJlYmFzZXVpLWFuZ3VsYXItbGlicmFyeS5zZXJ2aWNlLnRzIiwibmc6Ly9maXJlYmFzZXVpLWFuZ3VsYXIvbGliL2ZpcmViYXNldWktYW5ndWxhci1saWJyYXJ5LmhlbHBlci50cyIsIm5nOi8vZmlyZWJhc2V1aS1hbmd1bGFyL2xpYi9maXJlYmFzZXVpLWFuZ3VsYXItbGlicmFyeS5jb21wb25lbnQudHMiLCJuZzovL2ZpcmViYXNldWktYW5ndWxhci9saWIvZmlyZWJhc2V1aS1hbmd1bGFyLWxpYnJhcnkubW9kdWxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7QW5ndWxhckZpcmVBdXRofSBmcm9tICdhbmd1bGFyZmlyZTIvYXV0aCc7XG5pbXBvcnQgKiBhcyBmaXJlYmFzZXVpIGZyb20gJ2ZpcmViYXNldWknO1xuXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46ICdyb290J1xufSlcbmV4cG9ydCBjbGFzcyBGaXJlYmFzZXVpQW5ndWxhckxpYnJhcnlTZXJ2aWNlIHtcbiAgcHVibGljIGZpcmViYXNlVWlJbnN0YW5jZTogZmlyZWJhc2V1aS5hdXRoLkF1dGhVSTtcblxuICBjb25zdHJ1Y3Rvcihhbmd1bGFyRmlyZUF1dGg6IEFuZ3VsYXJGaXJlQXV0aCkge1xuICAgIC8vIHN0b3JlIHRoZSBmaXJlYmFzZXVpIGluc3RhbmNlIG9uIHRoZSB3aW5kb3cgb2JqZWN0IHRvIHByZXZlbnQgZG91YmxlIGluaXRpYWxpemF0aW9uXG4gICAgaWYgKCEoPGFueT53aW5kb3cpLmZpcmViYXNlVWlJbnN0YW5jZSkge1xuICAgICAgKDxhbnk+d2luZG93KS5maXJlYmFzZVVpSW5zdGFuY2UgPSBuZXcgZmlyZWJhc2V1aS5hdXRoLkF1dGhVSShhbmd1bGFyRmlyZUF1dGguYXV0aCk7XG4gICAgfVxuICAgIHRoaXMuZmlyZWJhc2VVaUluc3RhbmNlID0gKDxhbnk+d2luZG93KS5maXJlYmFzZVVpSW5zdGFuY2UgYXMgZmlyZWJhc2V1aS5hdXRoLkF1dGhVSTtcbiAgfVxufVxuIiwiXG4vKlxuICogQ3JlYXRlZCBieSBSYXBoYWVsIEplbm5pXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgUmFwaGFlbCBKZW5uaVxuICovXG5cbmltcG9ydCAqIGFzIGZpcmViYXNlIGZyb20gJ2ZpcmViYXNlL2FwcCc7XG5pbXBvcnQgQXV0aENyZWRlbnRpYWwgPSBmaXJlYmFzZS5hdXRoLkF1dGhDcmVkZW50aWFsO1xuaW1wb3J0IFVzZXIgPSBmaXJlYmFzZS5Vc2VyO1xuXG5leHBvcnQgY2xhc3MgRmlyZWJhc2VVSUF1dGhDb25maWcge1xuICAgIHByb3ZpZGVyczogQXJyYXk8QXV0aFByb3ZpZGVyIHwgQXV0aFByb3ZpZGVyV2l0aEN1c3RvbUNvbmZpZz47XG4gICAgbWV0aG9kPzogQXV0aE1ldGhvZHM7XG4gICAgc2lnbkluU3VjY2Vzc1VybD86IHN0cmluZztcbiAgICB0b3M/OiBzdHJpbmc7XG4gICAgY3JlZGVudGlhbEhlbHBlcj86IENyZWRlbnRpYWxIZWxwZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBGaXJlYmFzZVVJU2lnbkluU3VjY2VzcyB7XG4gICAgY3VycmVudFVzZXI6IFVzZXI7XG4gICAgY3JlZGVudGlhbDogQXV0aENyZWRlbnRpYWw7XG4gICAgcmVkaXJlY3RVcmw6IHN0cmluZztcbn1cblxuZXhwb3J0IGVudW0gQ3JlZGVudGlhbEhlbHBlciB7XG4gICAgQWNjb3VudENob29zZXIsIE9uZVRhcCwgTm9uZVxufVxuXG5leHBvcnQgZW51bSBBdXRoUHJvdmlkZXIge1xuICAgIEdvb2dsZSwgRmFjZWJvb2ssIFR3aXR0ZXIsIEdpdGh1YiwgUGFzc3dvcmQsIFBob25lXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXV0aFByb3ZpZGVyV2l0aEN1c3RvbUNvbmZpZyB7XG4gICAgcHJvdmlkZXI6IEF1dGhQcm92aWRlcjtcbiAgICBjdXN0b21Db25maWc6IE9iamVjdDtcbn1cblxuZXhwb3J0IGVudW0gQXV0aE1ldGhvZHMge1xuICAgIFBvcHVwLCBSZWRpcmVjdFxufVxuIiwiaW1wb3J0IHtDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgT25EZXN0cm95LCBPbkluaXQsIE91dHB1dH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1N1YnNjcmlwdGlvbn0gZnJvbSAncnhqcyc7XG5pbXBvcnQge1xuICBBdXRoTWV0aG9kcywgQXV0aFByb3ZpZGVyLFxuICBBdXRoUHJvdmlkZXJXaXRoQ3VzdG9tQ29uZmlnLCBDcmVkZW50aWFsSGVscGVyLFxuICBGaXJlYmFzZVVJQXV0aENvbmZpZyxcbiAgRmlyZWJhc2VVSVNpZ25JblN1Y2Nlc3Ncbn0gZnJvbSAnLi9maXJlYmFzZXVpLWFuZ3VsYXItbGlicmFyeS5oZWxwZXInO1xuaW1wb3J0ICogYXMgZmlyZWJhc2UgZnJvbSAnZmlyZWJhc2UnO1xuaW1wb3J0IEdvb2dsZUF1dGhQcm92aWRlciA9IGZpcmViYXNlLmF1dGguR29vZ2xlQXV0aFByb3ZpZGVyO1xuaW1wb3J0IEZhY2Vib29rQXV0aFByb3ZpZGVyID0gZmlyZWJhc2UuYXV0aC5GYWNlYm9va0F1dGhQcm92aWRlcjtcbmltcG9ydCBUd2l0dGVyQXV0aFByb3ZpZGVyID0gZmlyZWJhc2UuYXV0aC5Ud2l0dGVyQXV0aFByb3ZpZGVyO1xuaW1wb3J0IEdpdGh1YkF1dGhQcm92aWRlciA9IGZpcmViYXNlLmF1dGguR2l0aHViQXV0aFByb3ZpZGVyO1xuaW1wb3J0IEVtYWlsQXV0aFByb3ZpZGVyID0gZmlyZWJhc2UuYXV0aC5FbWFpbEF1dGhQcm92aWRlcjtcbmltcG9ydCBQaG9uZUF1dGhQcm92aWRlciA9IGZpcmViYXNlLmF1dGguUGhvbmVBdXRoUHJvdmlkZXI7XG5pbXBvcnQgKiBhcyBmaXJlYmFzZXVpIGZyb20gJ2ZpcmViYXNldWknO1xuaW1wb3J0IHtBbmd1bGFyRmlyZUF1dGh9IGZyb20gJ2FuZ3VsYXJmaXJlMi9hdXRoJztcbmltcG9ydCB7RmlyZWJhc2V1aUFuZ3VsYXJMaWJyYXJ5U2VydmljZX0gZnJvbSAnLi9maXJlYmFzZXVpLWFuZ3VsYXItbGlicmFyeS5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnZmlyZWJhc2UtdWknLFxuICB0ZW1wbGF0ZTogYFxuICAgIDxkaXYgaWQ9XCJmaXJlYmFzZXVpLWF1dGgtY29udGFpbmVyXCI+PC9kaXY+YFxufSlcbmV4cG9ydCBjbGFzcyBGaXJlYmFzZXVpQW5ndWxhckxpYnJhcnlDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XG5cbiAgQE91dHB1dCgnc2lnbkluU3VjY2VzcycpIHNpZ25JblN1Y2Nlc3NDYWxsYmFjazogRXZlbnRFbWl0dGVyPEZpcmViYXNlVUlTaWduSW5TdWNjZXNzPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICBwcml2YXRlIHN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuXG4gIHByaXZhdGUgc3RhdGljIGdldEF1dGhQcm92aWRlcihwcm92aWRlcjogQXV0aFByb3ZpZGVyKTogc3RyaW5nIHtcbiAgICBzd2l0Y2ggKHByb3ZpZGVyKSB7XG4gICAgICBjYXNlIEF1dGhQcm92aWRlci5Hb29nbGU6XG4gICAgICAgIHJldHVybiBHb29nbGVBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQ7XG4gICAgICBjYXNlIEF1dGhQcm92aWRlci5GYWNlYm9vazpcbiAgICAgICAgcmV0dXJuIEZhY2Vib29rQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lEO1xuICAgICAgY2FzZSBBdXRoUHJvdmlkZXIuVHdpdHRlcjpcbiAgICAgICAgcmV0dXJuIFR3aXR0ZXJBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQ7XG4gICAgICBjYXNlIEF1dGhQcm92aWRlci5HaXRodWI6XG4gICAgICAgIHJldHVybiBHaXRodWJBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQ7XG4gICAgICBjYXNlIEF1dGhQcm92aWRlci5QYXNzd29yZDpcbiAgICAgICAgcmV0dXJuIEVtYWlsQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lEO1xuICAgICAgY2FzZSBBdXRoUHJvdmlkZXIuUGhvbmU6XG4gICAgICAgIHJldHVybiBQaG9uZUF1dGhQcm92aWRlci5QUk9WSURFUl9JRDtcbiAgICB9XG4gIH1cblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFuZ3VsYXJGaXJlQXV0aDogQW5ndWxhckZpcmVBdXRoLFxuICAgICAgICAgICAgICBwcml2YXRlIGZpcmViYXNlVWlDb25maWc6IEZpcmViYXNlVUlBdXRoQ29uZmlnLFxuICAgICAgICAgICAgICBwcml2YXRlIGZpcmViYXNlVUlTZXJ2aWNlOiBGaXJlYmFzZXVpQW5ndWxhckxpYnJhcnlTZXJ2aWNlKSB7XG4gIH1cblxuICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbiA9IHRoaXMuYW5ndWxhckZpcmVBdXRoLmF1dGhTdGF0ZS5zdWJzY3JpYmUodmFsdWUgPT4ge1xuICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5maXJlYmFzZVVpQ29uZmlnLnByb3ZpZGVycy5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICB0aGlzLmZpcmViYXNlVUlQb3B1cCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlcmUgbXVzdCBiZSBhdCBsZWFzdCBvbmUgQXV0aFByb3ZpZGVyLicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAoISF0aGlzLnN1YnNjcmlwdGlvbikge1xuICAgICAgdGhpcy5zdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldFVJQXV0aENvbmZpZyhhdXRoQ29uZmlnOiBGaXJlYmFzZVVJQXV0aENvbmZpZyk6IE9iamVjdCB7XG4gICAgY29uc3QgYXV0aFByb3ZpZGVyczogQXJyYXk8T2JqZWN0PiA9IFtdO1xuICAgIGZvciAobGV0IHByb3ZpZGVyIG9mIGF1dGhDb25maWcucHJvdmlkZXJzKSB7XG4gICAgICBpZiAoISEocHJvdmlkZXIgYXMgQXV0aFByb3ZpZGVyV2l0aEN1c3RvbUNvbmZpZykuY3VzdG9tQ29uZmlnKSB7XG4gICAgICAgIHByb3ZpZGVyID0gKHByb3ZpZGVyIGFzIEF1dGhQcm92aWRlcldpdGhDdXN0b21Db25maWcpO1xuXG4gICAgICAgIGNvbnN0IHByb3ZpZGVyV2l0aENvbmZpZyA9IHByb3ZpZGVyLmN1c3RvbUNvbmZpZztcbiAgICAgICAgcHJvdmlkZXJXaXRoQ29uZmlnWydwcm92aWRlciddID0gRmlyZWJhc2V1aUFuZ3VsYXJMaWJyYXJ5Q29tcG9uZW50LmdldEF1dGhQcm92aWRlcihwcm92aWRlci5wcm92aWRlcik7XG5cbiAgICAgICAgYXV0aFByb3ZpZGVycy5wdXNoKHByb3ZpZGVyV2l0aENvbmZpZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhdXRoUHJvdmlkZXJzLnB1c2goRmlyZWJhc2V1aUFuZ3VsYXJMaWJyYXJ5Q29tcG9uZW50LmdldEF1dGhQcm92aWRlcihwcm92aWRlciBhcyBBdXRoUHJvdmlkZXIpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCB0b3NVUkwgPSBhdXRoQ29uZmlnLnRvcyA/IGF1dGhDb25maWcudG9zIDogJyc7XG5cbiAgICBsZXQgYXV0aE1ldGhvZCA9ICdwb3B1cCc7XG4gICAgc3dpdGNoIChhdXRoQ29uZmlnLm1ldGhvZCkge1xuICAgICAgY2FzZSBBdXRoTWV0aG9kcy5SZWRpcmVjdDpcbiAgICAgICAgYXV0aE1ldGhvZCA9ICdyZWRpcmVjdCc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBudWxsOlxuICAgICAgY2FzZSBBdXRoTWV0aG9kcy5Qb3B1cDpcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGxldCBjcmVkZW50aWFsSGVscGVyO1xuICAgIHN3aXRjaCAoYXV0aENvbmZpZy5jcmVkZW50aWFsSGVscGVyKSB7XG4gICAgICBjYXNlIENyZWRlbnRpYWxIZWxwZXIuTm9uZTpcbiAgICAgICAgY3JlZGVudGlhbEhlbHBlciA9IGZpcmViYXNldWkuYXV0aC5DcmVkZW50aWFsSGVscGVyLk5PTkU7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBDcmVkZW50aWFsSGVscGVyLk9uZVRhcDpcbiAgICAgICAgY3JlZGVudGlhbEhlbHBlciA9IGZpcmViYXNldWkuYXV0aC5DcmVkZW50aWFsSGVscGVyLkdPT0dMRV9ZT0xPO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgQ3JlZGVudGlhbEhlbHBlci5BY2NvdW50Q2hvb3NlcjpcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGNyZWRlbnRpYWxIZWxwZXIgPSBmaXJlYmFzZXVpLmF1dGguQ3JlZGVudGlhbEhlbHBlci5BQ0NPVU5UX0NIT09TRVJfQ09NO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICBjb25zdCBuYXRpdmVDb25maWd1cmF0aW9uOiBGaXJlYmFzZVVJTmF0aXZlQ29uZmlndXJhdGlvbiA9IHtcbiAgICAgIGNhbGxiYWNrczoge1xuICAgICAgICBzaWduSW5TdWNjZXNzOiAoY3VycmVudFVzZXIsIGNyZWRlbnRpYWwsIHJlZGlyZWN0VXJsKSA9PiB7XG4gICAgICAgICAgdGhpcy5zaWduSW5TdWNjZXNzQ2FsbGJhY2suZW1pdCh7XG4gICAgICAgICAgICBjdXJyZW50VXNlcixcbiAgICAgICAgICAgIGNyZWRlbnRpYWwsXG4gICAgICAgICAgICByZWRpcmVjdFVybFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiAhIWF1dGhDb25maWcuc2lnbkluU3VjY2Vzc1VybDtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHNpZ25JbkZsb3c6IGF1dGhNZXRob2QsXG4gICAgICBzaWduSW5PcHRpb25zOiBhdXRoUHJvdmlkZXJzLFxuICAgICAgdG9zVXJsOiB0b3NVUkwsXG4gICAgICBjcmVkZW50aWFsSGVscGVyOiBjcmVkZW50aWFsSGVscGVyXG4gICAgfTtcbiAgICBpZiAoISFhdXRoQ29uZmlnLnNpZ25JblN1Y2Nlc3NVcmwpIHtcbiAgICAgIG5hdGl2ZUNvbmZpZ3VyYXRpb24uc2lnbkluU3VjY2Vzc1VybCA9IGF1dGhDb25maWcuc2lnbkluU3VjY2Vzc1VybDtcbiAgICB9XG4gICAgcmV0dXJuIG5hdGl2ZUNvbmZpZ3VyYXRpb247XG4gIH1cblxuICBwcml2YXRlIGZpcmViYXNlVUlQb3B1cCgpIHtcbiAgICBjb25zdCBmaXJlYmFzZVVpSW5zdGFuY2UgPSB0aGlzLmZpcmViYXNlVUlTZXJ2aWNlLmZpcmViYXNlVWlJbnN0YW5jZTtcbiAgICBmaXJlYmFzZVVpSW5zdGFuY2Uuc3RhcnQoJyNmaXJlYmFzZXVpLWF1dGgtY29udGFpbmVyJywgdGhpcy5nZXRVSUF1dGhDb25maWcodGhpcy5maXJlYmFzZVVpQ29uZmlnKSk7XG4gIH1cbn1cblxuaW50ZXJmYWNlIEZpcmViYXNlVUlOYXRpdmVDb25maWd1cmF0aW9uIHtcbiAgY2FsbGJhY2tzPzogYW55O1xuICBjcmVkZW50aWFsSGVscGVyPzogYW55O1xuICBxdWVyeVBhcmFtZXRlckZvclNpZ25JblN1Y2Nlc3NVcmw/OiBzdHJpbmc7XG4gIHF1ZXJ5UGFyYW1ldGVyRm9yV2lkZ2V0TW9kZT86IHN0cmluZztcbiAgc2lnbkluRmxvdz86IHN0cmluZztcbiAgc2lnbkluT3B0aW9ucz86IGFueTtcbiAgc2lnbkluU3VjY2Vzc1VybD86IHN0cmluZztcbiAgdG9zVXJsOiBzdHJpbmc7XG59XG4iLCJpbXBvcnQge01vZHVsZVdpdGhQcm92aWRlcnMsIE5nTW9kdWxlfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7RmlyZWJhc2V1aUFuZ3VsYXJMaWJyYXJ5Q29tcG9uZW50fSBmcm9tICcuL2ZpcmViYXNldWktYW5ndWxhci1saWJyYXJ5LmNvbXBvbmVudCc7XG5pbXBvcnQge0NvbW1vbk1vZHVsZX0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7RmlyZWJhc2VVSUF1dGhDb25maWd9IGZyb20gJy4vZmlyZWJhc2V1aS1hbmd1bGFyLWxpYnJhcnkuaGVscGVyJztcblxuQE5nTW9kdWxlKHtcbiAgaW1wb3J0czogW1xuICAgIENvbW1vbk1vZHVsZVxuICBdLFxuICBkZWNsYXJhdGlvbnM6IFtGaXJlYmFzZXVpQW5ndWxhckxpYnJhcnlDb21wb25lbnRdLFxuICBleHBvcnRzOiBbRmlyZWJhc2V1aUFuZ3VsYXJMaWJyYXJ5Q29tcG9uZW50XVxufSlcbmV4cG9ydCBjbGFzcyBGaXJlYmFzZVVJTW9kdWxlIHtcbiAgc3RhdGljIGZvclJvb3QoZmlyZWJhc2VVaUF1dGhDb25maWc6IEZpcmViYXNlVUlBdXRoQ29uZmlnKTogTW9kdWxlV2l0aFByb3ZpZGVycyB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5nTW9kdWxlOiBGaXJlYmFzZVVJTW9kdWxlLFxuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIHtwcm92aWRlOiBGaXJlYmFzZVVJQXV0aENvbmZpZywgdXNlVmFsdWU6IGZpcmViYXNlVWlBdXRoQ29uZmlnfVxuICAgICAgXVxuICAgIH07XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJmaXJlYmFzZXVpLmF1dGgiLCJJbmplY3RhYmxlIiwiQW5ndWxhckZpcmVBdXRoIiwiZmlyZWJhc2UuYXV0aCIsIkV2ZW50RW1pdHRlciIsInRzbGliXzEuX192YWx1ZXMiLCJDb21wb25lbnQiLCJPdXRwdXQiLCJOZ01vZHVsZSIsIkNvbW1vbk1vZHVsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBO1FBVUUseUNBQVksZUFBZ0M7O1lBRTFDLElBQUksQ0FBQyxFQUFNLE1BQU0sR0FBRSxrQkFBa0IsRUFBRTtnQkFDckMsRUFBTSxNQUFNLEdBQUUsa0JBQWtCLEdBQUcsSUFBSUEsZUFBZSxDQUFDLE1BQU0sQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDckY7WUFDRCxJQUFJLENBQUMsa0JBQWtCLHFCQUFHLEVBQU0sTUFBTSxHQUFFLGtCQUE0QyxDQUFBLENBQUM7U0FDdEY7O29CQVpGQyxhQUFVLFNBQUM7d0JBQ1YsVUFBVSxFQUFFLE1BQU07cUJBQ25COzs7Ozt3QkFMT0Msa0JBQWU7Ozs7OENBRHZCOzs7Ozs7Ozs7OztBQ1VBLFFBQUE7OzttQ0FWQTtRQWdCQyxDQUFBO0FBTkQsUUFRQTs7O3NDQWxCQTtRQXNCQyxDQUFBO0FBSkQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQ1RBLElBQU8sa0JBQWtCLEdBQUdDLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQztJQUM3RCxJQUFPLG9CQUFvQixHQUFHQSxhQUFhLENBQUMsb0JBQW9CLENBQUM7SUFDakUsSUFBTyxtQkFBbUIsR0FBR0EsYUFBYSxDQUFDLG1CQUFtQixDQUFDO0lBQy9ELElBQU8sa0JBQWtCLEdBQUdBLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQztJQUM3RCxJQUFPLGlCQUFpQixHQUFHQSxhQUFhLENBQUMsaUJBQWlCLENBQUM7SUFDM0QsSUFBTyxpQkFBaUIsR0FBR0EsYUFBYSxDQUFDLGlCQUFpQixDQUFDO0FBQzNEO1FBZ0NFLDJDQUFvQixlQUFnQyxFQUNoQyxrQkFDQTtZQUZBLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjtZQUNoQyxxQkFBZ0IsR0FBaEIsZ0JBQWdCO1lBQ2hCLHNCQUFpQixHQUFqQixpQkFBaUI7eUNBdkJtRCxJQUFJQyxlQUFZLEVBQUU7U0F3QnpHOzs7OztRQXBCYyxpREFBZTs7OztzQkFBQyxRQUFzQjtnQkFDbkQsUUFBUSxRQUFRO29CQUNkLEtBQUssWUFBWSxDQUFDLE1BQU07d0JBQ3RCLE9BQU8sa0JBQWtCLENBQUMsV0FBVyxDQUFDO29CQUN4QyxLQUFLLFlBQVksQ0FBQyxRQUFRO3dCQUN4QixPQUFPLG9CQUFvQixDQUFDLFdBQVcsQ0FBQztvQkFDMUMsS0FBSyxZQUFZLENBQUMsT0FBTzt3QkFDdkIsT0FBTyxtQkFBbUIsQ0FBQyxXQUFXLENBQUM7b0JBQ3pDLEtBQUssWUFBWSxDQUFDLE1BQU07d0JBQ3RCLE9BQU8sa0JBQWtCLENBQUMsV0FBVyxDQUFDO29CQUN4QyxLQUFLLFlBQVksQ0FBQyxRQUFRO3dCQUN4QixPQUFPLGlCQUFpQixDQUFDLFdBQVcsQ0FBQztvQkFDdkMsS0FBSyxZQUFZLENBQUMsS0FBSzt3QkFDckIsT0FBTyxpQkFBaUIsQ0FBQyxXQUFXLENBQUM7aUJBQ3hDOzs7OztRQVFILG9EQUFROzs7WUFBUjtnQkFBQSxpQkFVQztnQkFUQyxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxVQUFBLEtBQUs7b0JBQ2hFLElBQUksQ0FBQyxLQUFLLEVBQUU7d0JBQ1YsSUFBSSxLQUFJLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7NEJBQ2hELEtBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQzt5QkFDeEI7NkJBQU07NEJBQ0wsTUFBTSxJQUFJLEtBQUssQ0FBQywwQ0FBMEMsQ0FBQyxDQUFDO3lCQUM3RDtxQkFDRjtpQkFDRixDQUFDLENBQUM7YUFDSjs7OztRQUVELHVEQUFXOzs7WUFBWDtnQkFDRSxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFO29CQUN2QixJQUFJLENBQUMsWUFBWSxDQUFDLFdBQVcsRUFBRSxDQUFDO2lCQUNqQzthQUNGOzs7OztRQUVPLDJEQUFlOzs7O3NCQUFDLFVBQWdDOztnQkFDdEQscUJBQU0sYUFBYSxHQUFrQixFQUFFLENBQUM7O29CQUN4QyxLQUFxQixJQUFBLEtBQUFDLGlCQUFBLFVBQVUsQ0FBQyxTQUFTLENBQUEsZ0JBQUE7d0JBQXBDLElBQUksUUFBUSxXQUFBO3dCQUNmLElBQUksQ0FBQyxDQUFDLEVBQUMsUUFBd0MsR0FBRSxZQUFZLEVBQUU7NEJBQzdELFFBQVEsS0FBSSxRQUF3QyxFQUFDLENBQUM7NEJBRXRELHFCQUFNLGtCQUFrQixHQUFHLFFBQVEsQ0FBQyxZQUFZLENBQUM7NEJBQ2pELGtCQUFrQixDQUFDLFVBQVUsQ0FBQyxHQUFHLGlDQUFpQyxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7NEJBRXRHLGFBQWEsQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQzt5QkFDeEM7NkJBQU07NEJBQ0wsYUFBYSxDQUFDLElBQUksQ0FBQyxpQ0FBaUMsQ0FBQyxlQUFlLG1CQUFDLFFBQXdCLEVBQUMsQ0FBQyxDQUFDO3lCQUNqRztxQkFDRjs7Ozs7Ozs7Ozs7Ozs7O2dCQUVELHFCQUFNLE1BQU0sR0FBRyxVQUFVLENBQUMsR0FBRyxHQUFHLFVBQVUsQ0FBQyxHQUFHLEdBQUcsRUFBRSxDQUFDO2dCQUVwRCxxQkFBSSxVQUFVLEdBQUcsT0FBTyxDQUFDO2dCQUN6QixRQUFRLFVBQVUsQ0FBQyxNQUFNO29CQUN2QixLQUFLLFdBQVcsQ0FBQyxRQUFRO3dCQUN2QixVQUFVLEdBQUcsVUFBVSxDQUFDO3dCQUN4QixNQUFNO29CQUNSLEtBQUssSUFBSSxDQUFDO29CQUNWLEtBQUssV0FBVyxDQUFDLEtBQUssQ0FBQztvQkFDdkI7d0JBQ0UsTUFBTTtpQkFDVDtnQkFFRCxxQkFBSSxnQkFBZ0IsQ0FBQztnQkFDckIsUUFBUSxVQUFVLENBQUMsZ0JBQWdCO29CQUNqQyxLQUFLLGdCQUFnQixDQUFDLElBQUk7d0JBQ3hCLGdCQUFnQixHQUFHTCxlQUFlLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDO3dCQUN6RCxNQUFNO29CQUNSLEtBQUssZ0JBQWdCLENBQUMsTUFBTTt3QkFDMUIsZ0JBQWdCLEdBQUdBLGVBQWUsQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLENBQUM7d0JBQ2hFLE1BQU07b0JBQ1IsS0FBSyxnQkFBZ0IsQ0FBQyxjQUFjLENBQUM7b0JBQ3JDO3dCQUNFLGdCQUFnQixHQUFHQSxlQUFlLENBQUMsZ0JBQWdCLENBQUMsbUJBQW1CLENBQUM7d0JBQ3hFLE1BQU07aUJBQ1Q7Z0JBRUQscUJBQU0sbUJBQW1CLEdBQWtDO29CQUN6RCxTQUFTLEVBQUU7d0JBQ1QsYUFBYSxFQUFFLFVBQUMsV0FBVyxFQUFFLFVBQVUsRUFBRSxXQUFXOzRCQUNsRCxLQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDO2dDQUM5QixXQUFXLGFBQUE7Z0NBQ1gsVUFBVSxZQUFBO2dDQUNWLFdBQVcsYUFBQTs2QkFDWixDQUFDLENBQUM7NEJBQ0gsT0FBTyxDQUFDLENBQUMsVUFBVSxDQUFDLGdCQUFnQixDQUFDO3lCQUN0QztxQkFDRjtvQkFDRCxVQUFVLEVBQUUsVUFBVTtvQkFDdEIsYUFBYSxFQUFFLGFBQWE7b0JBQzVCLE1BQU0sRUFBRSxNQUFNO29CQUNkLGdCQUFnQixFQUFFLGdCQUFnQjtpQkFDbkMsQ0FBQztnQkFDRixJQUFJLENBQUMsQ0FBQyxVQUFVLENBQUMsZ0JBQWdCLEVBQUU7b0JBQ2pDLG1CQUFtQixDQUFDLGdCQUFnQixHQUFHLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQztpQkFDcEU7Z0JBQ0QsT0FBTyxtQkFBbUIsQ0FBQzs7Ozs7O1FBR3JCLDJEQUFlOzs7O2dCQUNyQixxQkFBTSxrQkFBa0IsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsa0JBQWtCLENBQUM7Z0JBQ3JFLGtCQUFrQixDQUFDLEtBQUssQ0FBQyw0QkFBNEIsRUFBRSxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUM7OztvQkFySHZHTSxZQUFTLFNBQUM7d0JBQ1QsUUFBUSxFQUFFLGFBQWE7d0JBQ3ZCLFFBQVEsRUFBRSxvREFDbUM7cUJBQzlDOzs7Ozt3QkFQT0osa0JBQWU7d0JBWHJCLG9CQUFvQjt3QkFZZCwrQkFBK0I7Ozs7OENBU3BDSyxTQUFNLFNBQUMsZUFBZTs7Z0RBMUJ6Qjs7Ozs7OztBQ0FBOzs7Ozs7O1FBYVMsd0JBQU87Ozs7WUFBZCxVQUFlLG9CQUEwQztnQkFDdkQsT0FBTztvQkFDTCxRQUFRLEVBQUUsZ0JBQWdCO29CQUMxQixTQUFTLEVBQUU7d0JBQ1QsRUFBQyxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsUUFBUSxFQUFFLG9CQUFvQixFQUFDO3FCQUNoRTtpQkFDRixDQUFDO2FBQ0g7O29CQWZGQyxXQUFRLFNBQUM7d0JBQ1IsT0FBTyxFQUFFOzRCQUNQQyxtQkFBWTt5QkFDYjt3QkFDRCxZQUFZLEVBQUUsQ0FBQyxpQ0FBaUMsQ0FBQzt3QkFDakQsT0FBTyxFQUFFLENBQUMsaUNBQWlDLENBQUM7cUJBQzdDOzsrQkFYRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OyJ9